---
layout: doc_page
title: 'Updated: JavaScript HTTP Adapter'
date: 2014-12-17 08:00:40.000000000 +02:00
type: doc_page
published: true
status: publish
categories: []
tags:
- 7-0
meta:
  _wpcom_is_markdown: '1'
  _edit_last: '6637'
  _syntaxhighlighter_encoded: '1'
  _wpas_done_all: '1'
author:
  login: nathanh@il.ibm.com
  email: NATHANH@il.ibm.com
  display_name: Nathan Hazout
  first_name: NATHAN
  last_name: HAZOUT
---
<p class="breadcrumbs">
 &lt; <a href="https://developer.ibm.com/mobilefirstplatform/documentation/getting-started-7-0/server-side-development/">Server-side development</a></p>
<div id="samplesAndPersonas">
<div>
    Relevant to:</p>
<ul id="relevantForPersona">
<li class="ios">Native iOS</li>
<li class="android">Native Android</li>
<li class="wp8">Native Windows Phone 8</li>
<li class="wp8">Native Windows 8</li>
<li class="hybrid">Hybrid</li>
</ul></div>
<ul>
<li class="download-sample">
      <a href="http://public.dhe.ibm.com/software/products/en/MobileFirstPlatform/docs/v700/MobileFirstAdaptersProject.zip">Download Studio project</a>
    </li>
</ul>
</div>
<h2>Overview</h2>
<p>By using IBM MobileFirst Platform Foundation HTTP adapters, you can send GET or POST HTTP requests and retrieve data from the response headers and body. HTTP adapters work with RESTful and SOAP-based services, and can read structured HTTP sources such as RSS feeds.</p>
<p>You can easily customize HTTP adapters with simple server-side JavaScript code. For example, you could set up server-side filtering if necessary.<br />
The retrieved data can be in XML, HTML, JSON, or plain text format.</p>
<p>The adapter is configured with XML to define the adapter properties and procedures.<br />
Optionally, it is also possible to use XSL to filter received records and fields.</p>
<ul>
<li><a href="#creatingTheAdapter">Creating the adapter</a></li>
<li><a href="#adapterXmlStructure">Adapter XML structure</a></li>
<li><a href="#javaScriptImplementation">JavaScript implementation</a></li>
<li><a href="#xslTransformationFiltering">XSL transformation filtering</a></li>
<li><a href="#creatingSoapServiceRequest">Creating a SOAP-based service request</a></li>
<li><a href="#servicesDiscoveryWizard">Services discovery wizard</a></li>
<li><a href="#sampleApp">Sample application</a></li>
</ul>
<h2 id="creatingTheAdapter">Creating the adapter</h2>
<h3>CLI</h3>
<p>From the project's directory, use <code>mfp add adapter</code> and follow the interactive instructions.</p>
<h3>Studio</h3>
<p><a href="https://developer.ibm.com/mobilefirstplatform/wp-content/uploads/sites/32/2014/12/adapters_overview_70_select_adapter_type.png"><img src="{{ site.baseurl }}/assets/adapters_overview_70_select_adapter_type.png" alt="adapters_overview_70_select_adapter_type" width="527" height="361" class="aligncenter size-full wp-image-7142" /></a></p>
<p><a href="http://developer.ibm.com/mobilefirstplatform/wp-content/uploads/sites/32/2014/07/04_02_adapter-filestruct.png"><img src="{{ site.baseurl }}/assets/04_02_adapter-filestruct.png" alt="04_02_adapter-filestruct" width="199" height="138" class="alignright size-full wp-image-3504" /></a><br />
In MobileFirst Studio, create an adapter and select the <strong>HTTP Adapter</strong> type.<br />
A standard HTTP adapter structure is created.</p>
<p><br clear="all" /></p>
<h2 id="adapterXmlStructure">Adapter XML structure</h2>
<p>Settings and metadata are stored in the adapter XML file.<br />
You can use either the <strong>Design</strong> or <strong>Source</strong> editor in the Studio, or use your favorite XML editor to modify the adapter XML file.<br />
<a href="http://developer.ibm.com/mobilefirstplatform/wp-content/uploads/sites/32/2014/07/04_02_design-editor.png"><img src="{{ site.baseurl }}/assets/04_02_design-editor.png" alt="04_02_design-editor" width="1229" height="631" class="aligncenter size-full wp-image-3506" /></a></p>
<p>To edit the adapter XML file, you must:</p>
<ul>
<li>Set the protocol to HTTP or HTTPS.</li>
<li>Set the HTTP domain to the domain part of HTTP URL.</li>
<li>Set the TCP Port.</li>
</ul>
<p>Declare the required procedures below the connectivity element.</p>
<p>[code lang="xml"]<br />
&lt;wl:adapter name=&quot;HTTPAdapter&quot;<br />
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br />
  xmlns:wl=&quot;http://www.ibm.com/mfp/integration&quot;<br />
  xmlns:http=&quot;http://www.ibm.com/mfp/integration/http&quot;&gt;</p>
<p>  &lt;displayName&gt;HTTPAdapter&lt;/displayName&gt;<br />
  &lt;description&gt;HTTPAdapter&lt;/description&gt;<br />
  &lt;connectivity&gt;<br />
    &lt;connectionPolicy xsi:type=&quot;http:HTTPConnectionPolicyType&quot;&gt;<br />
      &lt;protocol&gt;http&lt;/protocol&gt;<br />
      &lt;domain&gt;rss.cnn.com&lt;/domain&gt;<br />
      &lt;port&gt;80&lt;/port&gt;<br />
      &lt;connectionTimeoutInMilliseconds&gt;30000&lt;/connectionTimeoutInMilliseconds&gt;<br />
      &lt;socketTimeoutInMilliseconds&gt;30000&lt;/socketTimeoutInMilliseconds&gt;<br />
      &lt;maxConcurrentConnectionsPerNode&gt;50&lt;/maxConcurrentConnectionsPerNode&gt;<br />
      &lt;!-- The following properties are used by the adapter's key manager for choosing specific certificate from the keystore.<br />
      &lt;sslCertificateAlias&gt;&lt;/sslCertificateAlias&gt;<br />
      &lt;sslCertificatePassword&gt;&lt;/sslCertificatePassword&gt;<br />
      --&gt;<br />
    &lt;/connectionPolicy&gt;<br />
  &lt;/connectivity&gt;</p>
<p>  &lt;procedure name=&quot;getStories&quot;/&gt;</p>
<p>  &lt;procedure name=&quot;getStoriesFiltered&quot;/&gt;</p>
<p>&lt;/wl:adapter&gt;<br />
[/code]</p>
<h2 id="javaScriptImplementation">JavaScript implementation</h2>
<p>Procedures are implemented in the adapter JavaScript file.<br />
The service URL is used for procedure invocations.</p>
<p>Some parts of the URL are constant; for example, http://example.com/. They are declared in the XML file.<br />
Other parts of the URL can be parameterized; that is, substituted at run time by parameter values that are provided to the MobileFirst procedure.</p>
<p>The following URL parts can be parameterized.</p>
<ul>
<li>Path elements</li>
<li>Query string parameters</li>
<li>Fragments</li>
</ul>
<blockquote><p>See the topic about "The connectionPolicy element of the HTTP adapter" in the user documentation for advanced options for adapters, such as cookies, headers, and encoding.
</p></blockquote>
<p><br clear="all" /></p>
<p>In the JavaScript file, use the same procedure name as in the XML file.<br />
The mandatory parameters to call the procedure are <code>method</code>, <code>path</code>, and <code>returnedContentType</code>.<br />
The procedure can be parameterized at run time.</p>
<p>[code lang="javascript"]<br />
function getFeeds() {<br />
  var input = {<br />
      method : 'get',<br />
      returnedContentType : 'xml',<br />
      path : &quot;rss.xml&quot;<br />
  };</p>
<p>  return WL.Server.invokeHttp(input);<br />
}<br />
[/code]</p>
<p>To call an HTTP request, use the <code>WL.Server.invokeHttp</code> method.<br />
Provide an input parameter object, which must specify:</p>
<ul>
<li>The HTTP method: <code>GET</code>,<code>POST</code>, <code>PUT</code>, <code>DELETE</code> </li>
<li>The returned content type: <code>XML</code>, <code>JSON</code>, <code>HTML</code>, or <code>plain</code></li>
<li>The service <code>path</code></li>
<li>The query parameters (optional)</li>
<li>The request body (optional)</li>
<li>The transformation type (optional)</li>
</ul>
<blockquote><p>See the topic about "WL.Server.invokeHttp" in the user documentation for a complete list of options.
</p></blockquote>
<p><br clear="all" /></p>
<h2 id="xslTransformationFiltering">XSL transformation filtering</h2>
<p>You can apply XSL transformation to the received data, for example to filter the data.<br />
To apply XSL transformation, specify the transformation options in the input parameters of the procedure invocation.</p>
<p>[code lang="javascript"]<br />
function getFeedsFiltered() {</p>
<p>  var input = {<br />
      method : 'get',<br />
      returnedContentType : 'xml',<br />
      path : &quot;rss.xml&quot;,<br />
      transformation : {<br />
        type : 'xslFile',<br />
        xslFile : 'filtered.xsl'<br />
      }<br />
  };</p>
<p>  return WL.Server.invokeHttp(input);<br />
}<br />
[/code]</p>
<h2 id="creatingSoapServiceRequest">Creating a SOAP-based service request</h2>
<p>You can use the <code>WL.Server.invokeHttp</code> method to create a <strong>SOAP</strong> envelope, which can be sent directly.</p>
<p>To call a SOAP-based service in an HTTP adapter, you must encode the SOAP XML envelope within the request body.<br />
Encoding XML within JavaScript is simple: just use <strong>E4X</strong>, which is officially part of JavaScript 1.6. You can use this technology to encode any type of XML document, not only SOAP envelopes.</p>
<p>If you receive error messages for SOAP envelopes, disable the JavaScript validator.<br />
Click <strong>Project > Properties > Builders</strong> and clear <strong>JavaScript Validator</strong>.</p>
<p>Use JavaScript to create a SOAP Envelope. It is possible to insert JavaScript code and variables into SOAP XML. Such additional code is evaluated at run time.</p>
<p>[code lang="javascript"]<br />
var request =<br />
  &lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;<br />
    &lt;soap:Body&gt;<br />
      &lt;CelsiusToFahrenheit xmlns=&quot;http://www.w3schools.com/webservices/&quot;&gt;<br />
        &lt;Celsius&gt;{celsiusTemp}&lt;/Celsius&gt;<br />
      &lt;/CelsiusToFahrenheit&gt;<br />
    &lt;/soap:Body&gt;<br />
  &lt;/soap:Envelope&gt;;</p>
<p>[/code]</p>
<p>The<code> WL.Server.invokeHttp(options)</code> method is used to call a request for a SOAP service.</p>
<p>The Options object must include the following properties:</p>
<ul>
<li>A <code>method</code> property: usually <code>POST</code></li>
<li>A <code>returnedContentType</code> property: usually <code>XML</code></li>
<li>A <code>path</code> property: a service path</li>
<li>A <code>body</code> property: <code>content</code> (SOAP XML as a string) and <code>contentType</code></li>
</ul>
<p>[code lang="javascript"]<br />
var input = {<br />
      method: 'post',<br />
      returnedContentType: 'xml',<br />
      path: '/webservices/tempconvert.asmx',<br />
      body: {<br />
        content: request.toString(),<br />
        contentType: 'text/xml; charset=utf-8',<br />
      },<br />
  };</p>
<p>  var result = WL.Server.invokeHttp(input);<br />
[/code]</p>
<h2 id="servicesDiscoveryWizard">Services discovery wizard</h2>
<p>With MobileFirst Studio, you can reduce development time by using the Discover Back-end Services tool in order to autogenerate adapters from the following services:</p>
<ul>
<li>IBM Business Process Manager</li>
<li>RESTful</li>
<li>SAP</li>
<li>WSDL</li>
</ul>
<ol>
<li>Right-click the services folder in a MobileFirst project and choose <strong>Discover back-end services</strong>, followed by selecting a type of service.
<p><a href="https://developer.ibm.com/mobilefirstplatform/wp-content/uploads/sites/32/2014/12/http_adapters_70_services_discovery_type.png"><img src="{{ site.baseurl }}/assets/http_adapters_70_services_discovery_type.png" alt="http_adapters_70_services_discovery_type" width="645" height="537" class="aligncenter size-full wp-image-7189" /></a>
</li>
<li>Add the service location to use and select the service that you want to add to the adapter.</li>
<li>Repeat for each service that you want to add. The service will be added to the same adapter.</li>
<p><a href="https://developer.ibm.com/mobilefirstplatform/wp-content/uploads/sites/32/2014/12/http_adapters_70_services_discovery_generate.png"><img src="{{ site.baseurl }}/assets/http_adapters_70_services_discovery_generate.png" alt="http_adapters_70_services_discovery_generate" width="645" height="538" class="aligncenter size-full wp-image-7190" /></a></p>
</ol>
<blockquote><p>For more information, see the topic about generating adapters with the services discovery wizard, in the user documentation.</p></blockquote>
<h2 id="sampleApp">Sample application</h2>
<p><a href="http://public.dhe.ibm.com/software/products/en/MobileFirstPlatform/docs/v700/MobileFirstAdaptersProject.zip">Click to download</a> the Studio project.</p>

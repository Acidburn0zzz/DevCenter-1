---
layout: doc_page
title: Storing sensitive data in encrypted cache
date: 2014-07-23 06:09:58.000000000 +03:00
type: doc_page
published: true
status: publish
categories: []
tags: []
meta:
  _wpcom_is_markdown: '1'
  _edit_last: '6643'
  _wpas_done_all: '1'
  _syntaxhighlighter_encoded: '1'
author:
  login: iadar@il.ibm.com
  email: IADAR@il.ibm.com
  display_name: IdanAdar
  first_name: IDAN
  last_name: ADAR
---
<p class="breadcrumbs">
 &lt; <a href="https://developer.ibm.com/mobilefirstplatform/documentation/getting-started-6-3/working-offline/">Working offline</a></p>
<div id="samplesAndPersonas">
<div>
    Relevant to:</p>
<ul id="relevantForPersona">
<li class="hybrid"><a href="https://developer.ibm.com/mobilefirstplatform/documentation/getting-started-hybrid-development-6-3/">Hybrid</a></li>
</ul>
</div>
<ul>
<li class="download-sample">
          <a href="http://public.dhe.ibm.com/software/products/en/MobileFirstPlatform/docs/v630/EncryptedCacheProject.zip">Download Studio project</a>
        </li>
</ul>
</div>
<h2>What is Encrypted Cache?</h2>
<p>Encrypted Cache is a mechanism for storing sensitive data on the client side.<br />
Encrypted Cache is implemented by using HTML5 web storage technology, which allows data to be saved locally and retrieved on subsequent application use or relaunch.</p>
<p>The Data is encrypted using a combination of a user-provided key and a server-retrieved randomly generated token, which makes it more secure<br />
Data is stored in key-value pairs.<br />
Encrypted Cache is like a security deposit box – it remains open until you close it, so it is important to remember to close the cache when finished working with it.</p>
<p>Encrypted Cache is similar to technologies such as:</p>
<ul>
<li>Local web or DOM storage
    </li>
<li>Indexed database API</li>
<li>Cordova API: Storage API or File API</li>
<li>JSONStore</li>
</ul>
<p>The table on the next slide shows how some features provided by Encrypted Cache compare with other technologies.</p>
<p><a href="http://developer.ibm.com/mobilefirstplatform/wp-content/uploads/sites/32/2014/07/06_02_cache_table.png"><img src="{{ site.baseurl }}/assets/backup/06_02_cache_table.png" alt="06_02_cache_table" width="1392" height="611" class="aligncenter size-full wp-image-1608" /></a></p>
<p>(1): These features are further described in the module JSONStore – Common JSONStore usage.<br />
(2): Reliable Storage means that your data is not deleted unless the application is removed from the device or one of the methods that removes data is called.<br />
(3): Dev. Only means that it is designed only for development. There are no security features and a ~5 MB storage space limit.</p>
<h2>Supported browsers and devices</h2>
<p>Encrypted cache is implemented by using HTML5 web storage technology.<br />
Mobile devices HTML5 web storage support chart:</p>
<p><a href="http://developer.ibm.com/mobilefirstplatform/wp-content/uploads/sites/32/2014/07/06_02_support_table.png"><img src="{{ site.baseurl }}/assets/backup/06_02_support_table.png" alt="06_02_support_table" width="1456" height="343" class="aligncenter size-full wp-image-1609" /></a></p>
<p><a href="http://developer.ibm.com/mobilefirstplatform/wp-content/uploads/sites/32/2014/07/06_02_support_table_legend.png"><img src="{{ site.baseurl }}/assets/backup/06_02_support_table_legend-300x24.png" alt="06_02_support_table_legend" width="300" height="24" class="aligncenter size-medium wp-image-1610" /></a></p>
<p>For more information, see <a href="http://caniuse.com">http://caniuse.com</a></p>
<h2>Creating and opening encrypted cache</h2>
<p>To create or open previously created encrypted cache, use the following API:</p>
<h3><span class="inline-code">WL.EncryptedCache.open(credentials, createIfNone, onComplete, onError);</span></h3>
<ul>
<li><span class="inline-code">credentials</span> – string value that represents user-provided password</li>
<li><span class="inline-code">createIfNone</span> – Boolean value that specifies whether new encrypted cache is created if none is found</li>
<li><span class="inline-code">onComplete</span> – a callback function to be invoked when cache opening/creating is complete</li>
<li><span class="inline-code">onError</span> - a callback function to be invoked when cache is not successfully opened/created</li>
</ul>
<p>[code lang="js"]WL.EncryptedCache.open(key, true, onOpenComplete, onOpenError);<br />
function onOpenComplete(status){<br />
    busyIndicator.hide();<br />
    alert(&quot;Encrypted cache succesfully opened&quot;);<br />
}[/code]</p>
<p>Note: The application must be able to connect to the MobileFirst Server to create a new encrypted cache.</p>
<p>A callback function can receive one of the following statuses:</p>
<ul>
<li><span class="inline-code">WL.EncryptedCache.OK</span> – Encrypted cache was successfully opened or created</li>
<li><span class="inline-code">WL.EncryptedCache.ERROR_CREDENTIALS_MISMATCH</span> – an attempt was made to open existing encrypted cache by using wrong credentials</li>
<li><span class="inline-code">WL.EncryptedCache.ERROR_SECURE_RANDOM_GENERATOR_UNAVAILABLE</span> – unable to generate random token due to MobileFirst Server unavailability</li>
<li><span class="inline-code">WL.EncryptedCache.ERROR_NO_EOC</span> – could not open encrypted cache because it was not previously created</li>
<li><span class="inline-code">WL.EncryptedCache.ERROR_LOCAL_STORAGE_NOT_SUPPORTED</span> – device does not support HTML5 local storage</li>
<li><span class="inline-code">WL.EncryptedCache.ERROR_KEY_CREATION_IN_PROGRESS</span> – an open() or changeCredentials() request is already running</li>
</ul>
<h4>Example</h4>
<p>[code lang="js"]WL.EncryptedCache.open(key, true, onOpenComplete, onOpenError);<br />
function onOpenComplete(status){<br />
    busyIndicator.hide();<br />
    alert(&quot;Encrypted cache succesfully opened&quot;);<br />
}</p>
<p>function onOpenError(status){<br />
    busyIndicator.hide();<br />
    switch(status){<br />
        case WL.EncryptedCache.ERROR_KEY_CREATION_IN_PROGRESS:<br />
            alert(&quot;ERROR: KEY CREATION IN PROGRESS&quot;);<br />
            break;<br />
        case WL.EncryptedCache.ERROR_LOCAL_STORAGE_NOT_SUPPORTED:<br />
            alert(&quot;ERROR: LOCAL STORAGE NOT SUPPORTED&quot;);<br />
            break;<br />
        case WL.EncryptedCache.ERROR_NO_EOC:<br />
            alert(&quot;ERROR: NO EOC&quot;);<br />
            break;<br />
        case WL.EncryptedCache.ERROR_COULD_NOT_GENERATE_KEY:<br />
            alert(&quot;ERROR: COULD NOT GENERATE KEY&quot;);<br />
            break;<br />
        case WL.EncryptedCache.ERROR_CREDENTIALS_MISMATCH:<br />
            alert(&quot;ERROR: CREDENTIALS MISMATCH&quot;);<br />
            break;<br />
        default:<br />
            alert(&quot;AN ERROR HAS OCCURED. STATUS :: &quot; + status);<br />
    }<br />
}[/code]</p>
<h2>Reading, Writing and Removing data using Encrypted Cache</h2>
<p>When the encrypted cache is open, operations such as reading, writing and removing data can be performed.</p>
<p>To store data in encrypted cache, use the following API:</p>
<h3><span class="inline-code">WL.EncryptedCache.write(key, value, onSuccess, onFailure);</span></h3>
<h4>Example:</h4>
<p>[code lang="js"]WL.EncryptedCache.write(key, value, onWriteSuccess, onWriteFailure);<br />
function onWriteSuccess(status){<br />
    alert(&quot;Succesfully encrypted into cache.&quot;);<br />
}<br />
function onWriteFailure(status){<br />
    if (status == WL.EncryptedCache.ERROR_EOC_CLOSED)<br />
        alert(&quot;Encrypted cache closed, write failed. error code= &quot;+ status);<br />
}[/code]</p>
<p>To read data from the encrypted cache, use the following API:</p>
<h3><span class="inline-code">WL.EncryptedCache.read(key, onSuccess, onFailure);</span></h3>
<h4>Example</h4>
<p>[code lang="js"]WL.EncryptedCache.read(key, onDecryptReadSuccess, onDecryptReadFailure);<br />
function onDecryptReadSuccess(value){<br />
    alert(&quot;Read success. Retrieved value :: &quot; + key + &quot; = &quot; + value);<br />
}<br />
function onDecryptReadFailure(status){<br />
    alert(&quot;Encrypted cache closed, reading failed&quot;);<br />
}[/code]</p>
<p>To remove data from the encrypted cache, use the following API:</p>
<h3><span class="inline-code">WL.EncryptedCache.remove(key, onSuccess, onFailure);</span></h3>
<h4>Example:</h4>
<p>[code lang="js"]WL.EncryptedCache.remove(key, onRemoveSuccess, onRemoveFailure);<br />
function onRemoveSuccess(status){<br />
    alert(&quot;Succesfully removed from cache.&quot;);<br />
}<br />
function onRemoveFailure(status){<br />
    alert(&quot;Encrypted cache closed, remove failed&quot;);<br />
}[/code]</p>
<h2>Closing and destroying Encrypted Cache</h2>
<p>To avoid possible undesired access to Encrypted Cache, close it.<br />
After an encrypted cache is closed, access to its data is not possible without the encryption key that was used to create it.</p>
<p>To close the encrypted cache, use the following API:</p>
<h3><span class="inline-code">WL.EncryptedCache.close(onComplete, onFailure);</span></h3>
<h4>Example:</h4>
<p>[code lang="js"]function destroyCacheClicked(){<br />
    WL.EncryptedCache.destroy(onDestroyCompleteHandler,<br />
    onDestroyErrorHandler);<br />
}<br />
function onDestroyCompleteHandler(status){<br />
    alert(&quot;Encrypted cache destroyed&quot;);<br />
}<br />
function onDestroyErrorHandler(status){<br />
    alert(&quot;Error destroying Encrypted cache&quot;);<br />
}[/code]</p>
<h2>Changing the encryption key</h2>
<p>While Encrypted Cache is in the open state, it is possible to change the encryption key.<br />
To do so, use the following API:</p>
<p><span class="inline-code">WL.EncryptedCache.changeCredentials(credentials, onComplete, onError)</span></p>
<ul>
<li><span class="inline-code">credentials</span> – new user password to be used</li>
<li><span class="inline-code">onComplete</span> – a callback function to be invoked when complete</li>
<li><span class="inline-code">onError</span> – a callback function to be invoked in case of an error</li>
<li><span class="inline-code">Callback</span> - receives a status object with the same structure as <span class="inline-code">WL.EncryptedCache.open()</span></li>
</ul>
<h2>Sample application</h2>
<p><a href="http://public.dhe.ibm.com/software/products/en/MobileFirstPlatform/docs/v630/EncryptedCacheProject.zip">Click to download</a> the Studio projet.</p>
<p><a href="http://developer.ibm.com/mobilefirstplatform/wp-content/uploads/sites/32/2014/07/06_02_sample.png"><img src="{{ site.baseurl }}/assets/backup/06_02_sample.png" alt="06_02_sample" width="772" height="373" class="aligncenter size-full wp-image-1625" /></a></p>

---
layout: tutorial
title: Android - Implementing Cordova plug-ins
relatedTo: [hybrid]
---
<ul>
        <li class="download-sample">
          <a href="http://public.dhe.ibm.com/software/products/en/MobileFirstPlatform/docs/v630/ApacheCordovaPluginsProject.zip">Download Studio project</a>
        </li>
    </ul>
</div>

<h2>Overview</h2>

In some cases, developers of a MobileFirst application might have to use a specific third-party native library or a device function that is not yet available in Apache Cordova.

With Apache Cordova, developers can create an Apache Cordova plug-in, which means that they create custom native code blocks, and call these code blocks in their applications by using JavaScript.

In this tutorial, a simple Apache Cordova plug-in creation and integration for Windows Phone 8 will be demonstrated.

<h3>Note:</h3>

In Cordova-based applications, developers must check for the <span class="inline-code">deviceready</span> event before they use the Cordova API set. In a MobileFirst application, however, this check is done internally.

Instead of implementing this check, implementation code can be placed in the <span class="inline-code">wlCommonInit()</span> function in <span class="inline-code">common\js\main.js</span>.

<br />
The below code blocks are based on the sample application, provided at the bottom of this tutorial.

<h3>Plug-in creation overview:</h3>

<ul>
    <li>Declare the plug-in in the config.xml file</li>
    <li>Use the <span class="inline-code">cordova.exec()</span> API in the JavaScript code</li>
    <li>Create the plug-in class that will run natively in Windows Phone 8</li>
    <li>The plug-in performs the required action and calls a JavaScript callback method that is specified during the call to <span class="inline-code">cordova.exec()</span></li>
</ul>

<a href="https://developer.ibm.com/mobileplatform/wp-content/uploads/sites/32/2014/07/07_07_overview.png"><img src="https://developer.ibm.com/mobileplatform/wp-content/uploads/sites/32/2014/07/07_07_overview.png" alt="07_07_overview" width="852" height="234" class="aligncenter size-full wp-image-1046" /></a>

<h2>Declaring a plug-in</h2>

The plug-in needs to be declared in the project, so that Cordova can detect it.
To declare the plug-in, add a reference to the config.xml file, located in the native folder of the Windows Phone 8 environment.

[code lang="xml"]<feature name=“sayHelloPlugin">
	<param name="wp-package" value=“sayHelloPlugin" />
</feature>[/code]

<h2>Implementing cordova.exec() in JavaScript</h2>

From the JavaScript code of the application, use <span class="inline-code">cordova.exec()</span> to call the Cordova plug-in:
[code lang="js"]function sayHello() {
    var name = $("#NameInput").val();
    cordova.exe(sayHelloSuccess, sayHelloFailure, "SayHelloPlugin", "sayHello", [name]);
}[/code]

<br clear="all"/>
<span class="inline-code">sayHelloSuccess</span> - Success callback
<span class="inline-code">sayHelloFailure</span> - Failure callback
<span class="inline-code">SayHelloPlugin</span> - Plug-in name as declared in config.xml
<span class="inline-code">sayHello</span> - Action name
<span class="inline-code">[name]</span> - Parameters array

The plug-in calls the <span class="inline-code">success</span> and <span class="inline-code">failure</span> callbacks.
[code lang="js" firstline="5"]
function sayHelloSuccess(data){
    WL.SimpleDialog.show(
        "Response from plug-in", data,
	[{text: "OK", handler: function() {WL.Logger.debug("Ok button pressed");}}]
    );
}

function sayHelloFailure(data){
    WL.SimpleDialog.show(
	"Response from plug-in", data,
	[{text: "OK", handler: function() {WL.Logger.debug("Ok button pressed");}}]
    );
}[/code]

<h2>Implementing the C# code of a Cordova plug-in</h2>

After the plug-in is declared, and the JavaScript implementation is ready, the Cordova plug-in can be implemented.
For this purpose, ensure that the project is built in Eclipse and opened in the Visual Studio IDE.

<h4>Step 1</h4>

<ul>
    <li>Create a new C# class</li>
    <li>Add the new class to your project namespace and add the required import statements.</li>

    [code lang="csharp"]using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

using WPCordovaClassLib.Cordova;
using WPCordovaClassLib.Cordova.Commands;
using WPCordovaClassLib.Cordova.JSON;

namespace Cordova.Extension.Commands
{
    public class SayHelloPlugin : BaseCommand
    {[/code]
</ul>

<h4>Step 2</h4>

Implement the <span class="inline-code">SayHelloPlugin</span> class and the <span class="inline-code">sayHello</span> method.

<ul>
    <li>The JavaScript wrapper calls the sayHello method and passes a single parameter. It returns a string back to JavaScript.
    [code lang="csharp" firstline="15"]public void sayHello(string options)
        {
            string optVal = null;
            try {
                optVal = JsonHelper.Deserialize<string[]>(options)[0];
            }
            catch (Exception) {
                DispatchCommandResult(new PluginResult(PluginResult.Status.ERROR, "SayHelloPlugin signaled an error"));
            }[/code]</li>

<br clear="all"/>
    <li>The DispatchCommandResult method returns the result to JavaScript, whether success or failure.
[code lang="csharp" firstline="24"]if (optVal == null)
            {
                DispatchCommandResult(new PluginResult(PluginResult.Status.ERROR, "Got null value as input"));
            }
            else
            {
                DispatchCommandResult(new PluginResult(PluginResult.Status.OK, "Hello " + optVal));
            }
        }
    }
}[/code]</li>
</ul>

<h2>Sample application</h2>
<a href="http://public.dhe.ibm.com/software/products/en/MobileFirstPlatform/docs/v630/ApacheCordovaPluginsProject.zip">Click to download</a> the Studio project.

<a href="https://developer.ibm.com/mobileplatform/wp-content/uploads/sites/32/2014/07/07_07_sample_app.png"><img src="https://developer.ibm.com/mobileplatform/wp-content/uploads/sites/32/2014/07/07_07_sample_app.png" alt="07_07_sample_app" width="598" height="381" class="aligncenter size-full wp-image-1051" /></a>

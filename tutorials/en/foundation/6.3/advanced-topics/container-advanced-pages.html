---
layout: tutorial
title: Container for advanced pages
relevantTo: [hybrid]
---
<ul>
<li class="download-sample">
          <a href="http://public.dhe.ibm.com/software/products/en/MobileFirstPlatform/docs/v630/ContainerForAdvancedPagesProject.zip">Download Studio project</a>
        </li>
</ul>

<h2>Prerequisites</h2>
<p>This tutorial assumes you know how to create a MobileFirst hybrid application and add Android and iPhone environments. For more information, see the following tutorials:</p>
<ul>
<li><a href="../../hello-world/creating-your-first-hybrid-application/">Creating your first hybrid application</a></li>
<li><a href="../../hello-world/previewing-application-ios/">Previewing your application on iOS</a></li>
<li><a href="../../hello-world/previewing-application-android/">Previewing your applicaiton on Android</a></li>
</ul>
<h2>Using this tutorial and its companion sample</h2>
<p>This tutorial and its companion sample are intended for use with either the IBM® MobileFirst® Consumer Edition or the IBM MobileFirst Enterprise Edition.<br />
You cannot use the sample that is associated with this tutorial as is with the free IBM MobileFirst Developer Edition. This sample provides a WAR file that demonstrates the remote load functionality in this tutorial. This WAR file requires a servlet container, such as Apache Tomcat, WebSphere®Application Server Full Profile, or WebSphere Application Server Liberty Profile.</p>
<p>Topics Covered:</p>
<ul>
<li><a href="#bkgrd">Background of IBM Mobile Conference application</a>
<ul>
<li><a href="#mobileViews">Mobile views</a></li>
<li><a href="#formClient">Form-based authentication - client</a></li>
<li><a href="#formServer">Form-based authentication - server</a></li>
<li><a href="#registry">Simplified user registry and role configuration</a></li>
</ul>
</li>
<li><a href="#migrate">Migrating applications to IBM MobileFirst Platform</a>
<ul>
<li><a href="#environments">Working with IBM MobileFirst projects and environments</a></li>
<li><a href="#android">Running the sample on an Android environment</a></li>
<li><a href="#iphone">Running the sample on an iPhone environment</a></li>
</ul>
</li>
<li><a href="#extend">IBM MobileFirst Platform Integration</a>
<ul>
<li><a href="#encrypt">Encrypted Cache</a></li>
<li><a href="#camera">Camera support</a></li>
</ul>
</li>
<li><a href="#proxy">Proxy considerations</a></li>
</ul>
<h2 id="bkgrd">Background of IBM Mobile Conference application</h2>
<ul>
<li>Mobile web application</li>
<li>Server programming model
<ul>
<li>JavaServer™ Pages (JSP)</li>
<li>JavaServer Pages Standard Tag Library (JSTL)</li>
<li>JavaServer Pages Expression Language (EL)</li>
</ul>
</li>
<li>Client programming model
<ul>
<li>Dojox Mobile</li>
<li>Dojo Mobile Device Theming</li>
</ul>
</li>
<li>Security
<ul>
<li>Container managed</li>
<li>Java™ Enterprise Edition (Java EE) form-based login</li>
</ul>
</li>
</ul>
<h3 id="mobileViews">Mobile views</h3>
<p>Dojo provides mobile widgets that developers can use to quickly generate mobile views.</p>
<p>[code lang="html" title="location.jsp" firstline="53"]<br />
<div id="locations" dojoType="dojox.mobile.ScrollableView" selected="true"&gt;<br />
    <h1 dojoType="dojox.mobile.Heading" label="Locations" fixed="top"&gt;</h1&gt;<br />
    <div class="list-category" dojoType="dojox.mobile.RoundRectCategory"&gt;USA</div&gt;<br />
    <ul dojoType="dojox.mobile.RoundRectList"&gt;<br />
        <c:forEach var="location" items="${applicationScope.locationRegistryList['usa']}"&gt;<br />
            <li dojoType="dojox.mobile.ListItem" class="mblVariableHeight"<br />
            url="./conferences.jsp?locationId=${location}"<br />
            urlTarget="conferences" transition="slide"&gt;<br />
                <div class="list-detail"&gt;<br />
                    <div&gt;${locationMap[location].city}, ${locationMap[location].state}</div&gt;<br />
                </div&gt;<br />
            </li&gt;<br />
        </c:forEach&gt;<br />
    </ul&gt;<br />
</div&gt;<br />
[/code]</p>
<p>JSTL provides a simple API for iterating over lists to generate Dojox Mobile list items dynamically on the server.</p>
<h3 id="formClient">Form-based authentication - client</h3>
<p>IBM Mobile Conference application requires users to be registered and authenticated with the enterprise that is hosting the application. The application is protected by a form-based login, by using a mobile web form that is contained within a Dojox Mobile view.</p>
<p><img src="{{ site.baseurl }}/assets/backup/login1.png"/></p>
<p>[code lang="html" title="logon.jsp" firstline="50"]<br />
<div dojoType="dojox.mobile.View"&gt;<br />
        <c:set var="conferences" scope="session"<br />
            value=""&gt;</c:set&gt;<br />
        <!-- a sample heading --&gt;<br />
        <h1 style="text-align: center;" dojoType="dojox.mobile.Heading"&gt;IBM Mobile Conference App</h1&gt;<br />
        <form action="j_security_check" method="post" name="loginForm"&gt;<br />
            <div class="logonClass"&gt;<br />
                <div&gt;<br />
                    <span&gt;Username </code&gt; <input id="username" dojoType="dojox.mobile.TextBox"<br />
                        name="j_username" /&gt;<br />
                </div&gt;<br />
                <div&gt;<br />
                    <span&gt;Password </code&gt; <input id="password" type=password name="j_password"<br />
                        dojoType="dojox.mobile.TextBox"&gt; </input&gt;</p>
<p>                </div&gt;<br />
                <div style="text-align: center;"&gt;<br />
                    <input id="login" type="submit" class="mblButton" value="Login"/&gt;<br />
                </div&gt;<br />
            </div&gt;<br />
        </form&gt;<br />
</div&gt;<br />
[/code]</p>
<h3 id="formServer">Form-based authentication - server</h3>
<p>The IBM Mobile Conference application is configured to use Java Enterprise Edition Role Support.</p>
<ul>
<li>White list or pattern-based URIs of secured resources</li>
<li>Support for logout in addition to Java Enterprise Edition standard logout functionality</li>
</ul>
<p>[code lang="xml" title="web.xml" firstline="29" highlight="30,41,42,43,46"]<br />
<security-role&gt;<br />
    <role-name&gt;worklightadmin</role-name&gt;<br />
</security-role&gt;<br />
<security-constraint&gt;<br />
    <display-name&gt;SecurityConstraint</display-name&gt;<br />
    <web-resource-collection&gt;<br />
        <web-resource-name&gt;Conference</web-resource-name&gt;<br />
        <url-pattern&gt;/common/location.jsp</url-pattern&gt;<br />
        <url-pattern&gt;/common/confs.jsp</url-pattern&gt;<br />
        <url-pattern&gt;/common/presenter.jsp</url-pattern&gt;<br />
        <url-pattern&gt;/common/sessions.jsp</url-pattern&gt;<br />
    </web-resource-collection&gt;<br />
    <auth-constraint&gt;<br />
        <role-name&gt;worklightadmin</role-name&gt;<br />
    </auth-constraint&gt;<br />
</security-constraint&gt;<br />
<login-config&gt;<br />
    <auth-method&gt;FORM</auth-method&gt;<br />
    <form-login-config&gt;<br />
        <form-login-page&gt;/common/logon.jsp</form-login-page&gt;<br />
        <form-error-page&gt;/common/logonError.jsp</form-error-page&gt;<br />
    </form-login-config&gt;<br />
</login-config&gt;<br />
[/code]</p>
<p>[code lang="html" title="location.jsp" firstline="114" highlight="115,118"]<br />
<div style="position: relative; float: left;"&gt;<br />
    <form method="post" action="conferenceLogout.jsp" name="logout"&gt;<br />
        <span data-dojo-type="dojox.mobile.ToolBarButton"<br />
            data-dojo-props='onClick:function(){<br />
                document.forms["logout"].submit();<br />
            },<br />
            transition:"slide"'&gt;Logout</code&gt;<br />
        <input type="hidden" name="logoutExitPage" value="/"&gt;<br />
    </form&gt;<br />
</div&gt;<br />
[/code]</p>
<h3 id="registry">Simplified user registry and role configuration</h3>
<p>Make these changes in your <strong>server.xml</strong> file, depending which server you use:</p>
<p>MobileFirst Development Server (Liberty):</p>
<p>[code lang="xml" title="server.xml" highlight="9,25-31,35-39"]<br />
<server description="new server"&gt;<br />
    <featureManager&gt;<br />
        <feature&gt;servlet-3.0</feature&gt;<br />
        <feature&gt;jndi-1.0</feature&gt;<br />
        <feature&gt;jdbc-4.0</feature&gt;<br />
        <feature&gt;localConnector-1.0</feature&gt;<br />
        <feature&gt;restConnector-1.0</feature&gt;<br />
        <feature&gt;jsp-2.2</feature&gt;<br />
        <feature&gt;appSecurity-1.0</feature&gt;<br />
        <feature&gt;ssl-1.0</feature&gt;<br />
    </featureManager&gt;</p>
<p>    ...</p>
<p>    <httpEndpoint host="*" httpPort="10080" httpsPort="10443" id="defaultHttpEndpoint"&gt;<br />
        <tcpOptions soReuseAddr="true"/&gt;</p>
<p>    </httpEndpoint&gt;</p>
<p>    ...<br />
    <applicationMonitor updateTrigger="mbean"/&gt;</p>
<p>    ...</p>
<p>    <basicRegistry id="worklight" realm="worklightRealm"&gt;<br />
        <user name="demo" password="demo"/&gt;<br />
        <user name="monitor" password="demo"/&gt;<br />
        <user name="deployer" password="demo"/&gt;<br />
        <user name="operator" password="demo"/&gt;<br />
        <user name="admin" password="admin"/&gt;<br />
    </basicRegistry&gt;</p>
<p>    ...<br />
    <webApplication contextRoot="conference" id="ContainerForAdvancedPagesWar" location="module_45_1_IntegrateExistingWebContentWar.war" name="ContainerForAdvancedPagesWar"&gt;<br />
        <application-bnd&gt;<br />
            <security-role name="worklightadmin"&gt;<br />
                <user name="admin"/&gt;<br />
            </security-role&gt;<br />
        </application-bnd&gt;<br />
    </webApplication&gt;</p>
<p>    <application context-root="/ContainerForAdvancedPages" id="ContainerForAdvancedPages" location="ContainerForAdvancedPages.war" name="ContainerForAdvancedPages" type="war"&gt;<br />
        <classloader commonLibraryRef="worklight-6.3.0"&gt;<br />
            <privateLibrary&gt;<br />
                <fileset dir="${wlp.user.dir}/shared/resources" includes="org.hsqldb.hsqldb_2.2.5.jar"/&gt;<br />
            </privateLibrary&gt;<br />
        </classloader&gt;<br />
    </application&gt;</p>
<p>    ...<br />
</server&gt;</p>
<p>[/code]</p>
<p>Tomcat server:</p>
<p>[code lang="xml" title="server.xml" highlight="9"]<br />
<GlobalNamingResources&gt;<br />
<!-- Editable user database that can also be used by<br />
     UserDatabaseRealm to authenticate users<br />
--&gt;<br />
<Resource auth="Container"<br />
    description="User database that can be updated and saved"<br />
    factory="org.apache.catalina.users.MemoryUserDatabaseFactory"<br />
    name="UserDatabase"<br />
    pathname="conf/tomcat-users.xml"<br />
    type="org.apache.catalina.UserDatabase"/&gt;<br />
</GlobalNamingResources&gt;<br />
[/code]</p>
<p>Add role and user in <strong>tomcat-users.xml</strong>:</p>
<p>[code lang="xml" title="tomcat-users.xml"]<br />
<role rolename="worklightadmin"/&gt;<br />
<user username="tomcat" password="tomcat" roles="worklightadmin"/&gt;<br />
[/code]</p>
<h2 id="migrate">Migrating applications to IBM MobileFirst Platform</h2>
<p>By using mobile web technology, you can deploy applications to the widest variety of devices.<br />
The presence of application stores (for example: Apple App Store and Google Play) adds a dimension where the hosting and marketing of these applications makes broader-reaching applications less relevant. IBM MobileFirst Platform provides the solution to building cross platform applications that can be distributed through the application stores by using the hybrid application programming model.<br />
In the hybrid model, developers typically package the application HTML, CSS, and JavaScript™ code as part of the application that is deployed to the application store. In this tutorial, you see the remote loading of dynamic content capability, where the HTML, CSS, and JavaScript code is hosted externally from the natively packaged hybrid.</p>
<h3 id="environments">Working with IBM MobileFirst projects and environments</h3>
<p>This tutorial is accompanied by a MobileFirst Project called <strong>ContainerForAdvancedPages</strong>, which contains an <strong>AdvancedPages</strong> hybrid application. This application already has iPhone and Android environments added to it.</p>
<p><img src="{{ site.baseurl }}/assets/backup/projectstructure-300x295.png"/></p>
<h3 id="android">Running the sample on an Android environment</h3>
<p>Make the following changes in <strong>AdvancedPages/android/nativeResources/src/com/AdvancedPages/AdvancedPages.java</strong>:</p>
<p>[code lang="java" title="AdvancedPages.java" firstline="45" highlight="48"]<br />
public void onInitWebFrameworkComplete(WLInitWebFrameworkResult result){<br />
    if (result.getStatusCode() == WLInitWebFrameworkResult.SUCCESS) {<br />
        WL.getInstance().hideSplashScreen();<br />
        super.loadUrl("http://localhost:10080/conference/common/location.jsp");</p>
<p>    }<br />
    else {<br />
        handleWebFrameworkInitFailure(result);<br />
    }<br />
}</p>
<p>[/code]</p>
<p>If running on Tomcat server, change port to 8080.</p>
<ol>
<li>If running on an actual Android device, replace <code>localhost</code> with your machine's public IP address. Make sure the device and your server are on the same network.</li>
<li>Right-click the WAR and select <strong>Run As > Run on Server</strong> and choose the MobileFirst Development Server.</li>
<li>Right-click the hybrid application and select <strong>Run As > Run on MobileFirst Development Server</strong>.</li>
<blockquote><p>Note: Due to same domain restrictions of the browser (web view), the remotely loaded application and MobileFirst Development Server must either be co-located on same host and port, or have a common proxy host and port.</p></blockquote>
<li>Right-click the Android project and select <strong>Run As > Android Application</strong>.</li>
</ol>
<p>After the application is installed, authenticate with username / password: "admin" / "admin", or whatever credentials you specified in your server.xml file.<br />
Each view for the IBM Mobile Conference app is loaded through Ajax XHR where each view is generated by the JSP responsible for each distinct view.</p>
<p><img src="{{ site.baseurl }}/assets/backup/android.jpg"/></p>
<h3 id="iphone">Running the sample on an iPhone environment</h3>
<p>Make the following changes in <strong>AdvancedPages/iphone/nativeResources/Classes/AdvancedPages.m</strong>:</p>
<p>[code lang="objc" title="AdvancedPages.m" firstline="63" highlight="83"]<br />
-(void)wlInitDidCompleteSuccessfully<br />
{</p>
<p>    [[WL sharedInstance] hideSplashScreen];</p>
<p>    UIViewController* rootViewController = self.window.rootViewController;</p>
<p>    // Create a Cordova View Controller<br />
    CDVViewController* cordovaViewController = [[CDVViewController alloc] init] ;</p>
<p>    cordovaViewController.startPage = [[WL sharedInstance] mainHtmlFilePath];</p>
<p>    // Adjust the Cordova view controller view frame to match its parent view bounds<br />
    cordovaViewController.view.frame = rootViewController.view.bounds;</p>
<p>    // Display the Cordova view<br />
    [rootViewController addChildViewController:cordovaViewController];<br />
    [rootViewController.view addSubview:cordovaViewController.view];</p>
<p>    NSString* remoteURLStr= @"http://localhost:10080/conference/common/location.jsp";<br />
                                                        NSURL* remoteURL = [NSURL URLWithString: remoteURLStr];<br />
                                                        NSURLRequest* request= [NSURLRequest requestWithURL:remoteURL];<br />
                                                        [cordovaViewController.webView loadRequest:request];<br />
}<br />
[/code]</p>
<p>If running on Tomcat server, change port to 8080.</p>
<ol>
<li>Right-click the WAR and select <strong>Run As > Run on Server</strong> and choose the MobileFirst Development Server.</li>
<li>Right-click the hybrid application and select <strong>Run As > Run on MobileFirst Development Server</strong>.</li>
<blockquote><p>Note: Due to same domain restrictions of the browser (web view), the remotely loaded application and MobileFirst Development Server must either be co-located on same host and port, or have a common proxy host and port.</p></blockquote>
<li>Right-click the iPhone folder and select <strong>Run As > Xcode project</strong>.</li>
<li>Run the Xcode project on an iOS simulator or device running iOS 7 or higher.</li>
</ol>
<p><img src="{{ site.baseurl }}/assets/backup/iphone.jpg"/></p>
<h2 id="extend">Extending IBM Mobile Conference app to IBM MobileFirst Platform</h2>
<h3>IBM MobileFirst Platform Integration</h3>
<p>IBM MobileFirst Platform provides client libraries for hybrid application development. Although the APIs are platform-neutral, they are often backed by platform-specific implementations. Because the conference app is served remotely, these client-side libraries must be packaged with the conference app (WAR). Each platform-specific implementation is in its own folder structure in the web application.</p>
<p>When the IBM Mobile Conference application completes the authentication process, the mobile device client initializes the device with the server by using <code>WL.Client.init()</code>. This provides a flexible model for application integrity validation, application updates, and other features.</p>
<p><img src="{{ site.baseurl }}/assets/backup/platformstructure-155x300.png"/></p>
<p>[code lang="html" title="location.jsp" firstline="39" highlight="42,46, language=51"]<br />
<c:choose&gt;<br />
    <c:when test="${fn:contains(iOSClient, 'Android')}"&gt;<br />
        <link rel="stylesheet" type="text/css"<br />
            href="dojox/mobile/themes/android/android.css"&gt;</link&gt;<br />
    </c:when&gt;<br />
    <c:otherwise&gt;<br />
        <link rel="stylesheet" type="text/css"<br />
            href="dojox/mobile/themes/iphone/iphone.css"&gt;</link&gt;<br />
    </c:otherwise&gt;<br />
</c:choose&gt;<br />
</head&gt;</p>
<p><body id="content" onload="WL.Client.init({onSuccess:function success(){ console.info('WL init success...'); }, connectOnStartup:false});"&gt;<br />
    <c:set var="locationMap" value='${applicationScope.locationRegistry}' scope="session"/&gt;</p>
<p>...</p>
<p>[/code]</p>
<p>[code lang="javascript" htmlscript="true" title="location.jsp" firstline="132"]<br />
<c:choose&gt;<br />
    <c:when test="${fn:contains(iOSClient, 'Android')}"&gt;</p>
<p>    <script&gt;<br />
        // Define WL namespace.<br />
        var WL = WL ? WL : {};<br />
        /**<br />
         * WLClient configuration variables.<br />
         * Values are injected by the deployer that packs the gadget.<br />
         */<br />
         WL.StaticAppProps = {<br />
   "APP_DISPLAY_NAME": "AdvancedPages",<br />
   "APP_ID": "AdvancedPages",<br />
   "APP_SERVICES_URL": "\/apps\/services\/",<br />
   "APP_VERSION": "1.0",<br />
   "ENVIRONMENT": "android",<br />
   "LOGIN_DISPLAY_TYPE": "embedded",<br />
   "WORKLIGHT_NATIVE_VERSION": "3826723549",<br />
   "WORKLIGHT_PLATFORM_VERSION": "6.3.0.0",<br />
   "WORKLIGHT_ROOT_URL": "\/apps\/services\/api\/AdvancedPages\/android\/"<br />
};<br />
</script&gt;</p>
<p>...<br />
    </c:when&gt;<br />
    <c:otherwise&gt;</p>
<p>     <script&gt;<br />
        // Define WL namespace.<br />
        var WL = WL ? WL : {};<br />
        /**<br />
         * WLClient configuration variables.<br />
         * Values are injected by the deployer that packs the gadget.<br />
         */<br />
         WL.StaticAppProps = {<br />
   "APP_DISPLAY_NAME": "AdvancedPages",<br />
   "APP_ID": "AdvancedPages",<br />
   "APP_SERVICES_URL": "\/apps\/services\/",<br />
   "APP_VERSION": "1.0",<br />
   "ENVIRONMENT": "iphone",<br />
   "LOGIN_DISPLAY_TYPE": "embedded",<br />
   "WORKLIGHT_NATIVE_VERSION": "270878231",<br />
   "WORKLIGHT_PLATFORM_VERSION": "6.3.0.0",<br />
   "WORKLIGHT_ROOT_URL": "\/apps\/services\/api\/AdvancedPages\/iphone\/"<br />
};<br />
</script&gt;<br />
...</p>
<p>    </c:otherwise&gt;<br />
</c:choose&gt;<br />
[/code]</p>
<h3 id="encrypt">Encrypted Cache</h3>
<p>The Encrypted Offline Cache (EOC) API is used for securely storing data by using HTML5 local cache. The Conference app uses EOC to save a list of favorite sessions in a secure way.</p>
<p><img src="{{ site.baseurl }}/assets/backup/eoc.jpg"/></p>
<p>[code lang="javascript" title="conference.js" firstline="35"]<br />
function __writeEOC(mykey, mydata, callback) {<br />
    WL.EncryptedCache.write(mykey, mydata, function() {<br />
        callback();<br />
    }, function() {<br />
        alert('An error occurred writing to the encrypted cache');<br />
    });<br />
}<br />
...<br />
function saveToCache(key, value) {</p>
<p>    if (isEOCOpen == false) {<br />
        __openEOC(function() {<br />
            __writeEOC(key, value, function() {<br />
            });<br />
        });<br />
    } else {<br />
        __writeEOC(key, value, function() {<br />
        }, function() {<br />
            alert('Unable to write to encrypted cache');<br />
        });<br />
    }<br />
}<br />
[/code]</p>
<h3 id="camera">Camera support</h3>
<p>Use the IBM MobileFirst Client API to extend the application to take photos of the conference. The application has a social aspect, where users can view photos from the other conference attendees.</p>
<p><img src="{{ site.baseurl }}/assets/backup/photo1.jpg"/></p>
<h2 id="proxy">Proxy considerations</h2>
<p>IBM MobileFirst Platform is compatible with most known proxy solutions.</p>
<p>WebSphere HTTP Plug-in support: Requires single shared <code>plugin-cfg.xml</code> for routing requests to both the MobileFirst Development Server and the WebSphere Application Server that is hosting the IBM Mobile Conference App.</p>
<p>Apache Web Server support: Requires mod_proxy module to be loaded by the web server.</p>
<h2 class="noPrint">Sample application</h2>
<p><a href="http://public.dhe.ibm.com/software/products/en/MobileFirstPlatform/docs/v630/ContainerForAdvancedPagesProject.zip">Click to download</a> the Studio project.</p>

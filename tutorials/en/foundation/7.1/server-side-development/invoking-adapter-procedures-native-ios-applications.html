---
layout: tutorial
title: Resource request from native iOS Objective-C applications
date: 2015-04-16 08:03:16.000000000 +03:00
type: tutorial
published: true
status: publish
categories: []
tags:
- 7-1
meta:
  _wpcom_is_markdown: '1'
  _edit_last: '6643'
  _wpas_done_all: '1'
  _syntaxhighlighter_encoded: '1'
author:
  login: nathanh@il.ibm.com
  email: NATHANH@il.ibm.com
  display_name: Nathan Hazout
  first_name: NATHAN
  last_name: HAZOUT
---
<div id="samplesAndPersonas">
<div>
    Relevant to:</p>
<ul id="relevantForPersona">
<li class="ios">Native iOS
      </li>
</ul></div>
<ul>
<li class="download-sample">
<a href="https://github.com/MobileFirst-Platform-Developer-Center/InvokingAdapterProcedures" target="_blank">Download MobileFirst project</a>
    </li>
<li class="download-sample">
<a href="https://github.com/MobileFirst-Platform-Developer-Center/InvokingAdapterProceduresObjC" target="_blank">Download Native project</a>
    </li>
</ul>
</div>
<h2>Overview</h2>
<p>To create and configure an iOS native project, first follow the “<a href="https://developer.ibm.com/mobilefirstplatform/documentation/getting-started-7-1/hello-world/configuring-a-native-ios-application-with-the-mfp-sdk/" title="Configuring a native iOS application with the MobileFirst Platform SDK">Configuring a native iOS application with the MobileFirst Platform SDK</a>” tutorial.</p>
<p>MobileFirst applications can access resources using the <code>WLResourceRequest</code> REST API.<br />
This tutorial explains how to use the <code>WLResourceRequest</code> API with an HTTP adapter.</p>
<h2>Initializing WLClient</h2>
<ol>
<li>Access the <code>WLClient</code> functionality by using<br />
<code>[WLClient sharedInstance]</code> anywhere in your application.
</li>
<li>Initiate the connection to the server by using the <code>wlConnectWithDelegate</code> method.<br />
For most actions, you must specify a delegate object, such as a <code>MyConnectListener</code> instance in the following example:</p>
<p>[code lang="obj-c"]<br />
MyConnectListener *connectListener = [[MyConnectListener alloc] initWithController:self];<br />
[[WLClient sharedInstance] wlConnectWithDelegate:connectListener];<br />
[/code]</p>
<p><strong>Note:</strong> Remember to <code>#import &lt;IBMMobileFirstPlatformFoundation/IBMMobileFirstPlatformFoundation.h&gt;</code> when using the MobileFirst SDK.</p>
</li>
<li>Create a delegate to be used in the <code>wlConnectWithDelegate</code> method and receive the response from the MobileFirst Server instance. Name the class <code>MyConnectListener</code>.<br />
The header file must specify that it implements the <code>WLDelegate</code> protocol.</p>
<p>[code lang="obj-c"]<br />
@interface MyConnectListener : NSObject &lt;WLDelegate&gt; {<br />
    @private<br />
    ViewController *vc;<br />
}</p>
<p>[/code]</p>
<p>The <code>WLDelegate</code> protocol specifies that the class implements the following methods:<br />
- The <code>onSuccess</code> method: <code>(WLResponse *)response</code><br />
- The <code>onFailure</code> method: <code>(WLFailResponse *)response</code></p>
<p>After <code>wlConnectWithDelegate</code> finishes, the <code>onSuccess</code> method or the <code>onFailure</code> method of the supplied <code>MyConnectListener</code> instance is invoked.<br />
In both cases, the response object is sent as an argument.
</li>
<li>Use this object to operate data that is retrieved from the server.
<p>[code lang="obj-c"]<br />
-(void)onSuccess:(WLResponse *)response{<br />
    NSLog(@&quot;\nConnection Success: %@&quot;, response);<br />
    NSString *resultText = @&quot;Connection success. &quot;;</p>
<p>    if ([response responseText] != nil){<br />
        resultText = [resultText stringByAppendingString:[response responseText]];<br />
    }<br />
    [vc updateView:resultText];<br />
}</p>
<p>-(void)onFailure:(WLFailResponse *)response{<br />
    NSString *resultText = @&quot;Connection failure. &quot;;</p>
<p>    if ([response responseText] != nil){<br />
        resultText = [resultText stringByAppendingString:[response responseText]];<br />
    }<br />
    [vc updateView:resultText];<br />
}<br />
[/code]</li>
</ol>
<h2>Invoking an adapter procedure</h2>
<p>After the connection is established with a MobileFirst Server instance, you can use the <code>WLResourceRequest</code> class to invoke adapter procedures or call any REST resources.</p>
<ol>
<li> Define the URI of the resource. For a JavaScript HTTP adapter: <code>/adapters/{AdapterName}/{ProcedureName}</code><br />
[code lang="obj-c"]<br />
NSURL* url = [NSURL URLWithString:@&quot;/adapters/RSSReader/getFeed&quot;];<br />
[/code]
</li>
<li>Create a <code>WLResourceRequest</code> object and choose the HTTP method (GET, POST, etc).<br />
[code lang="obj-c"]<br />
WLResourceRequest* request = [WLResourceRequest requestWithURL:url method:WLHttpMethodGet];<br />
[/code]</p>
</li>
<li>Add the required parameters.
<ul>
<li>For JavaScript-based adapters, use the <code>params</code> parameter name to set an array of parameters.<br />
[code lang="obj-c"]<br />
[request setQueryParameterValue:@&quot;['MobileFirst_Platform']&quot; forName:@&quot;params&quot;];<br />
[/code]
</li>
<li>For Java adapters or other resources, you can use <code>setQueryParameterValue</code> for each parameter.<br />
[code lang="obj-c"]<br />
[request setQueryParameterValue:@&quot;value1&quot; forName:@&quot;param1&quot;];<br />
[request setQueryParameterValue:@&quot;value2&quot; forName:@&quot;param2&quot;];<br />
[/code]
</li>
</ul>
</li>
<li>Trigger the request with a call to the <code>sendWithCompletionHandler</code> method.<br />
Specify a <code>completionHandler</code> instance.</p>
<p>[code lang="obj-c"]<br />
    [request sendWithCompletionHandler:^(WLResponse *response, NSError *error) {<br />
        NSString* resultText;<br />
        if(error != nil){<br />
            resultText = @&quot;Invocation failure.&quot;;<br />
            resultText = [resultText stringByAppendingString: error.description];<br />
        }<br />
        else{<br />
            resultText = @&quot;Invocation success.&quot;;<br />
            resultText = [resultText stringByAppendingString:response.responseText];<br />
        }<br />
        [self updateView:resultText];<br />
    }];<br />
[/code]</p>
<p>Other signatures, which are not covered in this tutorial, exist for the <code>send</code> method. Those signatures enable you to set parameters in the body instead of the query, or to handle the response with a delegate instead of a completion handler. See the user documentation to learn more.
</li>
</ol>
<h2>Sample and result</h2>
<p><a href="https://github.com/MobileFirst-Platform-Developer-Center/InvokingAdapterProcedures" target="_blank">Click to download</a> the MobileFirst project.</p>
<p><a href="https://github.com/MobileFirst-Platform-Developer-Center/InvokingAdapterProceduresObjC" target="_blank">Click to download</a> the Native project.</p>
<ul>
<li>The <code>InvokingAdapterProcedures</code> project contains a <strong>MobileFirst native API</strong> which you can deploy to your MobileFirst Server instance and required to deploy to the server.</li>
<li>The <code>InvokingAdapterProceduresObjC</code> project contains a <strong>native iOS application</strong> that uses a MobileFirst native API library to communicate with the MobileFirst Server instance.</li>
<li>Make sure to update the <code>worklight.plist</code> file in <strong>NativeiOSInvoking</strong> with the relevant server settings.</li>
</ul>
<p><a href="https://developer.ibm.com/mobilefirstplatform/wp-content/uploads/sites/32/2014/12/ios-invoke-adapter-procedure-result.png"><img src="{{ site.baseurl }}/assets/backup/ios-invoke-adapter-procedure-result.png" alt="ios-invoke-adapter-procedure-result" width="375" height="689" class="aligncenter size-full wp-image-9694" /></a></p>
